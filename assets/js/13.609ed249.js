(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{239:function(t,s,a){"use strict";a.r(s);var n=a(0),o=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("p",[t._v("邮件收到报错信息如下：")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{attrs:{class:"token number"}},[t._v("2018")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("11")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("07")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("16")]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("13")]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("59")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token number"}},[t._v("867")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ERROR"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("XNIO"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("3")]),t._v(" task"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("68")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("f"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("p"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("s"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("p"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TsPurchaseServiceImpl"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" 生产应付单失败Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\ncom"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysql"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exceptions"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc4"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySQLTransactionRollbackException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\n\tat sun"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reflect"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NativeConstructorAccessorImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("newInstance0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Native Method"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat sun"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reflect"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NativeConstructorAccessorImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("newInstance")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NativeConstructorAccessorImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("57")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat sun"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reflect"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DelegatingConstructorAccessorImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("newInstance")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DelegatingConstructorAccessorImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("45")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lang"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reflect"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Constructor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("newInstance")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Constructor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("526")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{attrs:{class:"token operator"}},[t._v("<")]),a("span",{attrs:{class:"token operator"}},[t._v("!")]),a("span",{attrs:{class:"token operator"}},[t._v("--")]),t._v(" more "),a("span",{attrs:{class:"token operator"}},[t._v("--")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("air"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tqb"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("filter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ClientExceptionFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ClientExceptionFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("36")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProtocolFilterWrapper$"),a("span",{attrs:{class:"token number"}},[t._v("1.")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProtocolFilterWrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("91")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("air"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tqb"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("filter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ClientInfoConsumerFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ClientInfoConsumerFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("52")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProtocolFilterWrapper$"),a("span",{attrs:{class:"token number"}},[t._v("1.")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProtocolFilterWrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("91")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("filter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FutureFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FutureFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("53")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProtocolFilterWrapper$"),a("span",{attrs:{class:"token number"}},[t._v("1.")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProtocolFilterWrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("91")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("monitor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MonitorFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MonitorFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("75")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProtocolFilterWrapper$"),a("span",{attrs:{class:"token number"}},[t._v("1.")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProtocolFilterWrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("91")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("filter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ConsumerContextFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ConsumerContextFilter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("48")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProtocolFilterWrapper$"),a("span",{attrs:{class:"token number"}},[t._v("1.")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProtocolFilterWrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("91")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InvokerWrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("InvokerWrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("53")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cluster"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FailoverClusterInvoker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("doInvoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FailoverClusterInvoker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("77")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cluster"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AbstractClusterInvoker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AbstractClusterInvoker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("227")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cluster"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wrapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MockClusterInvoker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MockClusterInvoker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("72")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rpc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InvokerInvocationHandler"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("InvokerInvocationHandler"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("52")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alibaba"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dubbo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("common"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bytecode"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy31"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("genPayment")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proxy31"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xiaoxin"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("purchase"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("impl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("purchase"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TsPurchaseServiceImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("inStockPurchase")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TsPurchaseServiceImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("472")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xiaoxin"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("purchase"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("impl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("purchase"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TsPurchaseServiceImpl$$FastClassBySpringCGLIB$$"),a("span",{attrs:{class:"token number"}},[t._v("405")]),t._v("c4cc7"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token generics function"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("generated"),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cglib"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MethodProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MethodProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("204")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("aop"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CglibAopProxy$CglibMethodInvocation"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invokeJoinpoint")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CglibAopProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("738")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("aop"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReflectiveMethodInvocation"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("proceed")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ReflectiveMethodInvocation"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("157")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransactionInterceptor$"),a("span",{attrs:{class:"token number"}},[t._v("1.")]),a("span",{attrs:{class:"token function"}},[t._v("proceedWithInvocation")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TransactionInterceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("99")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransactionAspectSupport"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invokeWithinTransaction")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TransactionAspectSupport"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("282")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransactionInterceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TransactionInterceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("96")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("由于"),a("code",[t._v("com.xiaoxin.purchase.service.impl.purchase.TsPurchaseServiceImpl.inStockPurchase(TsPurchaseServiceImpl.java:472)")]),t._v("业务内部调用了dubbo接口，\n这里看不到接口内部的具体超时情况，在这个时间的另外一个系统收到的报错邮件如下：")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{attrs:{class:"token number"}},[t._v("2018")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("11")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("07")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("16")]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("13")]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("59")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token number"}},[t._v("859")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ERROR"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("DubboServerHandler"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("10.25")]),a("span",{attrs:{class:"token number"}},[t._v(".24")]),a("span",{attrs:{class:"token number"}},[t._v(".204")]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("20880")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("thread"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("188")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("t"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("s"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExceptionHandlerAspect"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v("\n### Error querying database"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("  Cause"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysql"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exceptions"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc4"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySQLTransactionRollbackException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\n### The error may exist in URL "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("jar"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v("file"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("apache"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("tomcat"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("7.0")]),a("span",{attrs:{class:"token number"}},[t._v(".70")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("erp"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("webapps"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("kzf6"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("WEB"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("INF"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("biz"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("mapper"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1.0")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("SNAPSHOT"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jar"),a("span",{attrs:{class:"token operator"}},[t._v("!")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("sqlmap"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("BaseMapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xml"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n### The error may involve defaultParameterMap\n### The error occurred "),a("span",{attrs:{class:"token keyword"}},[t._v("while")]),t._v(" setting parameters\n### SQL"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" select "),a("span",{attrs:{class:"token function"}},[t._v("genatorBillNo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token function"}},[t._v("CAST")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v("  as unsigned "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n### Cause"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysql"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exceptions"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc4"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySQLTransactionRollbackException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SQL "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" nested exception is com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysql"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exceptions"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc4"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySQLTransactionRollbackException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\nIP"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v("null\nIdOwnOrg"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("10546050787349562379")]),t._v("\nUserID"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("10546050787350232730")]),t._v("\nType"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v("DUBBO\nAction"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v("genPayment"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("purchase\nArgs"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v('"YFD"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token string"}},[t._v('"2018-11-07"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token string"}},[t._v('"10546050787349562379"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\norg"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dao"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeadlockLoserDataAccessException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v("\n### Error querying database"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("  Cause"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysql"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exceptions"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc4"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySQLTransactionRollbackException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\n### The error may exist in URL "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("jar"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v("file"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("apache"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("tomcat"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("7.0")]),a("span",{attrs:{class:"token number"}},[t._v(".70")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("erp"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("webapps"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("kzf6"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("WEB"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("INF"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("biz"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("mapper"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1.0")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("SNAPSHOT"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jar"),a("span",{attrs:{class:"token operator"}},[t._v("!")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("sqlmap"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("BaseMapper"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xml"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n### The error may involve defaultParameterMap\n### The error occurred "),a("span",{attrs:{class:"token keyword"}},[t._v("while")]),t._v(" setting parameters\n### SQL"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" select "),a("span",{attrs:{class:"token function"}},[t._v("genatorBillNo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token function"}},[t._v("CAST")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v("  as unsigned "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n### Cause"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysql"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exceptions"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc4"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySQLTransactionRollbackException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SQL "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" nested exception is com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysql"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exceptions"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc4"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySQLTransactionRollbackException"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deadlock found when trying to get lock"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" restarting transaction\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SQLErrorCodeSQLExceptionTranslator"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("doTranslate")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SQLErrorCodeSQLExceptionTranslator"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("269")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jdbc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AbstractFallbackSQLExceptionTranslator"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("translate")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AbstractFallbackSQLExceptionTranslator"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("72")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mybatis"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spring"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MyBatisExceptionTranslator"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("translateExceptionIfPossible")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyBatisExceptionTranslator"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("74")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mybatis"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spring"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SqlSessionTemplate$SqlSessionInterceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SqlSessionTemplate"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("421")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sun"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$Proxy51"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("selectOne")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unknown Source"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mybatis"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spring"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SqlSessionTemplate"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("selectOne")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SqlSessionTemplate"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("166")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ibatis"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("binding"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MapperMethod"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("execute")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MapperMethod"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("69")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ibatis"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("binding"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MapperProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MapperProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("53")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sun"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$Proxy54"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getBillNo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unknown Source"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("air"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tqb"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("impl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BaseServiceImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getBillNo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BaseServiceImpl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("75")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat com"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("air"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tqb"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("impl"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BaseServiceImpl$$FastClassBySpringCGLIB$$"),a("span",{attrs:{class:"token number"}},[t._v("80")]),t._v("aa6800"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token generics function"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("generated"),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cglib"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MethodProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MethodProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("204")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("aop"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CglibAopProxy$CglibMethodInvocation"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invokeJoinpoint")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CglibAopProxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("700")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("aop"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReflectiveMethodInvocation"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("proceed")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ReflectiveMethodInvocation"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("150")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransactionInterceptor$"),a("span",{attrs:{class:"token number"}},[t._v("1.")]),a("span",{attrs:{class:"token function"}},[t._v("proceedWithInvocation")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TransactionInterceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("96")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransactionAspectSupport"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invokeWithinTransaction")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TransactionAspectSupport"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("260")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nat org"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransactionInterceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("invoke")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TransactionInterceptor"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{attrs:{class:"token operator"}},[t._v(":")]),a("span",{attrs:{class:"token number"}},[t._v("94")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("发现"),a("code",[t._v("select genatorBillNo(?,?,CAST(? as unsigned ))")]),t._v("时超时，赶紧让运维同学dump出线上的死锁日志如下：")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("------------------------")]),t._v("\nLATEST  DETECTED  DEADLOCK\n"),a("span",{attrs:{class:"token comment"}},[t._v("------------------------")]),t._v("\n"),a("span",{attrs:{class:"token number"}},[t._v("2018")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("11")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("07")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("16")]),t._v(":"),a("span",{attrs:{class:"token number"}},[t._v("13")]),t._v(":"),a("span",{attrs:{class:"token number"}},[t._v("59")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("0x7f8f23d34700")]),t._v("\n"),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("  "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v(":\n"),a("span",{attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("288341382")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  ACTIVE  "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("  sec  fetching  "),a("span",{attrs:{class:"token keyword"}},[t._v("rows")]),t._v("\nmysql  "),a("span",{attrs:{class:"token keyword"}},[t._v("tables")]),t._v("  "),a("span",{attrs:{class:"token operator"}},[t._v("in")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("use")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  locked  "),a("span",{attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("LOCK")]),t._v("  WAIT  "),a("span",{attrs:{class:"token number"}},[t._v("304")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("lock")]),t._v("  struct"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  heap  size  "),a("span",{attrs:{class:"token number"}},[t._v("41168")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("2069")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("row")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("lock")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nMySQL  thread  id  "),a("span",{attrs:{class:"token number"}},[t._v("1523982")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  OS  thread  handle  "),a("span",{attrs:{class:"token number"}},[t._v("140248716125952")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  query  id  "),a("span",{attrs:{class:"token number"}},[t._v("7086375026")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("10.25")]),a("span",{attrs:{class:"token number"}},[t._v(".24")]),a("span",{attrs:{class:"token number"}},[t._v(".204")]),t._v("  root  Searching  "),a("span",{attrs:{class:"token keyword"}},[t._v("rows")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("update")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v("  tm_billno_sn  n  "),a("span",{attrs:{class:"token keyword"}},[t._v("SET")]),t._v("  next_sn  "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("  n"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next_sn"),a("span",{attrs:{class:"token operator"}},[t._v("+")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v("\nn"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("business_type  "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("    NAME_CONST"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'bill_type'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("_utf8mb4"),a("span",{attrs:{class:"token string"}},[t._v("'YFD'")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v("  "),a("span",{attrs:{class:"token string"}},[t._v("'utf8mb4_bin'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{attrs:{class:"token operator"}},[t._v("AND")]),t._v("  DATE_FORMAT"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sn_date"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token string"}},[t._v("'%Y-%m-%d'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("    NAME_CONST"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'bill_date'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("_utf8mb4"),a("span",{attrs:{class:"token string"}},[t._v("'2018-11-07'")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v("  "),a("span",{attrs:{class:"token string"}},[t._v("'utf8mb4_bin'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{attrs:{class:"token operator"}},[t._v("AND")]),t._v("  n"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id_own_org  "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("    NAME_CONST"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'id_own_org'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token number"}},[t._v("10546050787349562379")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("  "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  WAITING  "),a("span",{attrs:{class:"token keyword"}},[t._v("FOR")]),t._v("  THIS  "),a("span",{attrs:{class:"token keyword"}},[t._v("LOCK")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("TO")]),t._v("  BE  GRANTED:\nRECORD  LOCKS  space  id  "),a("span",{attrs:{class:"token number"}},[t._v("2011")]),t._v("  page  "),a("span",{attrs:{class:"token keyword"}},[t._v("no")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("12297")]),t._v("  n  bits  "),a("span",{attrs:{class:"token number"}},[t._v("336")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("index")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("of")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("table")]),t._v("  "),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("f6dms"),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("tm_billno_sn"),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("  trx  id  "),a("span",{attrs:{class:"token number"}},[t._v("288341382")]),t._v("  lock_mode  X  locks  rec  but  "),a("span",{attrs:{class:"token operator"}},[t._v("not")]),t._v("  gap  waiting\nRecord  "),a("span",{attrs:{class:"token keyword"}},[t._v("lock")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  heap  "),a("span",{attrs:{class:"token keyword"}},[t._v("no")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("122")]),t._v("  PHYSICAL  RECORD:  n_fields  "),a("span",{attrs:{class:"token number"}},[t._v("7")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  compact  format"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  info  bits  "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v(":  len  "),a("span",{attrs:{class:"token number"}},[t._v("8")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  hex  "),a("span",{attrs:{class:"token number"}},[t._v("925")]),t._v("b1950d335e7a8"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("asc")]),t._v("    "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  P  "),a("span",{attrs:{class:"token number"}},[t._v("5")]),t._v("    "),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v(":  len  "),a("span",{attrs:{class:"token number"}},[t._v("6")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  hex  "),a("span",{attrs:{class:"token number"}},[t._v("00000868")]),t._v("dc16"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("asc")]),t._v("        h    "),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token number"}},[t._v("2")]),t._v(":  len  "),a("span",{attrs:{class:"token number"}},[t._v("7")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  hex  "),a("span",{attrs:{class:"token number"}},[t._v("270000015")]),t._v("b2407"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("asc")]),t._v("  "),a("span",{attrs:{class:"token string"}},[t._v("'      [$  ;;\n  3:  len  10;  hex  47442020202020202020;  asc  GD                ;;\n  4:  len  8;  hex  0000000000000003;  asc                  ;;\n  5:  len  8;  hex  925b1950d333040b;  asc    [  P  3    ;;\n  6:  len  3;  hex  8fc4de;  asc        ;;\n\n***  (2)  TRANSACTION:\nTRANSACTION  288341314,  ACTIVE  1  sec  fetching  rows\nmysql  tables  in  use  3,  locked  3\n6340  lock  struct(s),  heap  size  778448,  1678750  row  lock(s)\nMySQL  thread  id  1523984,  OS  thread  handle  140252758099712,  query  id  7086372072  10.25.24.204  root  Sending  data\nSELECT  next_sn  INTO  seq  FROM  tm_billno_sn    s  WHERE  s.business_type  =  '")]),t._v("TQB'  "),a("span",{attrs:{class:"token keyword"}},[t._v("FOR")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v("\n"),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("  "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  HOLDS  THE  "),a("span",{attrs:{class:"token keyword"}},[t._v("LOCK")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("S"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":\nRECORD  LOCKS  space  id  "),a("span",{attrs:{class:"token number"}},[t._v("2011")]),t._v("  page  "),a("span",{attrs:{class:"token keyword"}},[t._v("no")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("12297")]),t._v("  n  bits  "),a("span",{attrs:{class:"token number"}},[t._v("336")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("index")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("of")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("table")]),t._v("  "),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("f6dms"),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("tm_billno_sn"),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("  trx  id  "),a("span",{attrs:{class:"token number"}},[t._v("288341314")]),t._v("  lock_mode  X\nRecord  "),a("span",{attrs:{class:"token keyword"}},[t._v("lock")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  heap  "),a("span",{attrs:{class:"token keyword"}},[t._v("no")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v("  PHYSICAL  RECORD:  n_fields  "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  compact  format"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  info  bits  "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),a("p",[t._v("关键原因：")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token number"}},[t._v("6340")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("lock")]),t._v("  struct"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  heap  size  "),a("span",{attrs:{class:"token number"}},[t._v("778448")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("1678750")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("row")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("lock")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nMySQL  thread  id  "),a("span",{attrs:{class:"token number"}},[t._v("1523984")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  OS  thread  handle  "),a("span",{attrs:{class:"token number"}},[t._v("140252758099712")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  query  id  "),a("span",{attrs:{class:"token number"}},[t._v("7086372072")]),t._v("  "),a("span",{attrs:{class:"token number"}},[t._v("10.25")]),a("span",{attrs:{class:"token number"}},[t._v(".24")]),a("span",{attrs:{class:"token number"}},[t._v(".204")]),t._v("  root  Sending  "),a("span",{attrs:{class:"token keyword"}},[t._v("data")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("  next_sn  "),a("span",{attrs:{class:"token keyword"}},[t._v("INTO")]),t._v("  seq  "),a("span",{attrs:{class:"token keyword"}},[t._v("FROM")]),t._v("  tm_billno_sn    s  "),a("span",{attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v("  s"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("business_type  "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("  "),a("span",{attrs:{class:"token string"}},[t._v("'TQB'")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("FOR")]),t._v("  "),a("span",{attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v("\n")])])]),a("p",[t._v("查找相关代码和function找到罪魁祸首："),a("code",[t._v("genatorOrgNo")])]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("DEFINER")]),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("root"),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{attrs:{class:"token variable"}},[t._v("@`%`")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("FUNCTION")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),t._v("genatorOrgNo"),a("span",{attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("RETURNS")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("255")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("CHARSET")]),t._v(" utf8\n"),a("span",{attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("DECLARE")]),t._v(" newBillNo "),a("span",{attrs:{class:"token keyword"}},[t._v("VARCHAR")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("20")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("''")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t"),a("span",{attrs:{class:"token comment"}},[t._v("#生成最新单据号")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("DECLARE")]),t._v(" seq "),a("span",{attrs:{class:"token keyword"}},[t._v("BIGINT")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t\t\t\t\t\t\t"),a("span",{attrs:{class:"token comment"}},[t._v("#当前单据序列")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("DECLARE")]),t._v(" seqStr "),a("span",{attrs:{class:"token keyword"}},[t._v("VARCHAR")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("10")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("''")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),a("span",{attrs:{class:"token comment"}},[t._v("#序列补0")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" next_sn "),a("span",{attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" seq "),a("span",{attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" tm_billno_sn  s "),a("span",{attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" s"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("business_type "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'TQB'")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("FOR")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("UPDATE")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" seq "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("THEN")]),t._v("\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" tm_billno_sn"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pk_id"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("business_type"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next_sn"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("id_own_org"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sn_date"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UUID_SHORT"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token string"}},[t._v("'TQB'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token number"}},[t._v("0002")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" seq "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("001")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("ELSE")]),t._v("\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" tm_billno_sn "),a("span",{attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" next_sn "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" next_sn"),a("span",{attrs:{class:"token operator"}},[t._v("+")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" business_type "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'TQB'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("END")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("IF")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" seqStr "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" LPAD"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seq"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token number"}},[t._v("4")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token string"}},[t._v("'0'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" newBillNo "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" CONCAT"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'CHS'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("DATE_FORMAT"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token function"}},[t._v("NOW")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token string"}},[t._v("'%Y%m%d'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("seqStr"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("RETURN")]),t._v(" newBillNo"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])])]),a("p",[t._v("解决办法就是将这个function修改掉，将生成单号的序列保存到另一张表中。")])])}],!1,null,null,null);o.options.__file="deadLockSolve.md";s.default=o.exports}}]);