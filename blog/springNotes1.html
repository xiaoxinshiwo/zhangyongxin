<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>spring4.3读书笔记1 | 博客</title>
    <meta name="description" content="zhangyongxin&#39;s blog">
    <link rel="icon" href="/zhangyongxin/favicon.ico">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    
    <link rel="preload" href="/zhangyongxin/assets/css/styles.74657ed2.css" as="style"><link rel="preload" href="/zhangyongxin/assets/js/app.74657ed2.js" as="script"><link rel="preload" href="/zhangyongxin/assets/css/styles.74657ed2.css" as="style"><link rel="preload" href="/zhangyongxin/assets/js/29.75726558.js" as="script"><link rel="prefetch" href="/zhangyongxin/assets/css/1.styles.542cba6d.css"><link rel="prefetch" href="/zhangyongxin/assets/css/8.styles.4fe9bba1.css"><link rel="prefetch" href="/zhangyongxin/assets/js/1.542cba6d.js"><link rel="prefetch" href="/zhangyongxin/assets/js/10.64cadbad.js"><link rel="prefetch" href="/zhangyongxin/assets/js/11.9a671232.js"><link rel="prefetch" href="/zhangyongxin/assets/js/12.0e7cc131.js"><link rel="prefetch" href="/zhangyongxin/assets/js/13.609ed249.js"><link rel="prefetch" href="/zhangyongxin/assets/js/14.d6836a4c.js"><link rel="prefetch" href="/zhangyongxin/assets/js/15.7b74c80f.js"><link rel="prefetch" href="/zhangyongxin/assets/js/16.4895ae83.js"><link rel="prefetch" href="/zhangyongxin/assets/js/17.530d124f.js"><link rel="prefetch" href="/zhangyongxin/assets/js/18.b239cccc.js"><link rel="prefetch" href="/zhangyongxin/assets/js/19.b60b50ff.js"><link rel="prefetch" href="/zhangyongxin/assets/js/2.1e22d7f8.js"><link rel="prefetch" href="/zhangyongxin/assets/js/20.7b9d30ef.js"><link rel="prefetch" href="/zhangyongxin/assets/js/21.976a9872.js"><link rel="prefetch" href="/zhangyongxin/assets/js/22.21400a1f.js"><link rel="prefetch" href="/zhangyongxin/assets/js/23.43378c47.js"><link rel="prefetch" href="/zhangyongxin/assets/js/24.47ac6988.js"><link rel="prefetch" href="/zhangyongxin/assets/js/25.d0c557ef.js"><link rel="prefetch" href="/zhangyongxin/assets/js/26.e799ec6c.js"><link rel="prefetch" href="/zhangyongxin/assets/js/27.9e0b1fb5.js"><link rel="prefetch" href="/zhangyongxin/assets/js/28.981cd19c.js"><link rel="prefetch" href="/zhangyongxin/assets/js/3.5d4c971b.js"><link rel="prefetch" href="/zhangyongxin/assets/js/30.e5b2bc2d.js"><link rel="prefetch" href="/zhangyongxin/assets/js/31.f35faab8.js"><link rel="prefetch" href="/zhangyongxin/assets/js/32.695115bf.js"><link rel="prefetch" href="/zhangyongxin/assets/js/33.d2d9144b.js"><link rel="prefetch" href="/zhangyongxin/assets/js/34.c16c5295.js"><link rel="prefetch" href="/zhangyongxin/assets/js/35.be01aa78.js"><link rel="prefetch" href="/zhangyongxin/assets/js/36.0a450691.js"><link rel="prefetch" href="/zhangyongxin/assets/js/37.cd1af253.js"><link rel="prefetch" href="/zhangyongxin/assets/js/38.1d1a4b90.js"><link rel="prefetch" href="/zhangyongxin/assets/js/4.7bab5812.js"><link rel="prefetch" href="/zhangyongxin/assets/js/5.7301bdbe.js"><link rel="prefetch" href="/zhangyongxin/assets/js/6.233a4d13.js"><link rel="prefetch" href="/zhangyongxin/assets/js/7.e8149bf7.js"><link rel="prefetch" href="/zhangyongxin/assets/js/8.4fe9bba1.js"><link rel="prefetch" href="/zhangyongxin/assets/js/9.08fcbe3b.js">
    <link rel="stylesheet" href="/zhangyongxin/assets/css/1.styles.542cba6d.css"><link rel="stylesheet" href="/zhangyongxin/assets/css/8.styles.4fe9bba1.css"><link rel="stylesheet" href="/zhangyongxin/assets/css/styles.74657ed2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="wrap"><div class="theme-container container no-sidebar"><header class="navbar"><div class="nav-header"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zhangyongxin/" class="home-link router-link-active"><img src="https://ae01.alicdn.com/kf/HTB1uzODadzvK1RkSnfo762MwVXai.png" class="logo"> <span class="site-name can-hide">
        博客
      </span></a> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zhangyongxin/" class="nav-link">首页</a></div><div class="nav-item"><a href="/zhangyongxin/tags/" class="nav-link">分类</a></div><div class="nav-item"><a href="/zhangyongxin/tools/toolCollections.html" class="nav-link">工具</a></div><div class="nav-item"><a href="/zhangyongxin/about/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/xiaoxinshiwo" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div> <!----></nav> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zhangyongxin/" class="nav-link">首页</a></div><div class="nav-item"><a href="/zhangyongxin/tags/" class="nav-link">分类</a></div><div class="nav-item"><a href="/zhangyongxin/tools/toolCollections.html" class="nav-link">工具</a></div><div class="nav-item"><a href="/zhangyongxin/about/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/xiaoxinshiwo" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div> <!----></nav> <!----></div> <div class="page-container"><div><div class="page card"><div class="content-header"><h1 class="page-title" style="color:#ac0b39;">
        spring4.3读书笔记1
      </h1> <span class="page-timestamp">2018-05-15 22:08:19</span></div> <div class="content"><ol><li>logging</li></ol> <blockquote><p>A more common choice amongst SLF4J users, which uses fewer steps and generates fewer dependencies, is to bind directly to Logback. This removes the extra binding step because Logback implements SLF4J directly, so you only need to depend on just two libraries, namely jcl-over-slf4j and logback):</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
        &lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;
        &lt;version&gt;1.7.21&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
        &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
        &lt;version&gt;1.1.7&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre></div> <ol start="2"><li>spring历届版本新特性</li></ol> <blockquote><p>The Spring Framework was first released in 2004; since then there have been significant major revisions: Spring 2.0 provided XML namespaces and AspectJ support; Spring 2.5 embraced annotation-driven configuration; Spring 3.0 introduced a strong Java 5+ foundation across the framework codebase, and features such as the Java-based @Configuration model.
Version 4.0 is the latest major release of the Spring Framework and the first to fully support Java 8 features. You can still use Spring with older versions of Java, however, the minimum requirement has now been raised to Java SE 6. We have also taken the opportunity of a major release to remove many deprecated classes and methods.</p></blockquote> <ol start="3"><li>Maven &quot;Bill Of Materials&quot; Dependency</li></ol> <blockquote><p>It is possible to accidentally mix different versions of Spring JARs when using Maven. For example, you may find that a third-party library, or another Spring project, pulls in a transitive dependency to an older release. If you forget to explicitly declare a direct dependency yourself, all sorts of unexpected issues can arise.
To overcome such problems Maven supports the concept of a &quot;bill of materials&quot; (BOM) dependency. You can import the spring-framework-bom in your dependencyManagement section to ensure that all spring dependencies (both direct and transitive) are at the same version.</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-framework-bom&lt;/artifactId&gt;
            &lt;version&gt;4.3.17.RELEASE&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
</code></pre></div><blockquote><p>An added benefit of using the BOM is that you no longer need to specify the <code>&lt;version&gt;</code> attribute when depending on Spring Framework artifacts:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;dependencies&gt;
</code></pre></div><p>4、泛型注入支持</p> <blockquote><p>In addition to the @Qualifier annotation, it is also possible to use Java generic types as an implicit form of qualification. For example, suppose you have the following configuration:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>@Configuration
public class MyConfiguration {

    @Bean
    public StringStore stringStore() {
        return new StringStore();
    }

    @Bean
    public IntegerStore integerStore() {
        return new IntegerStore();
    }
}
</code></pre></div><blockquote><p>Assuming that beans above implement a generic interface, i.e. <code>Store&lt;String&gt;</code> and <code>Store&lt;Integer&gt;</code>, you can @Autowire the Store interface and the generic will be used as a qualifier:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>@Autowired
private Store&lt;String&gt; s1; // &lt;String&gt; qualifier, injects the stringStore bean

@Autowired
private Store&lt;Integer&gt; s2; // &lt;Integer&gt; qualifier, injects the integerStore bean
Generic qualifiers also apply when autowiring Lists, Maps and Arrays:

// Inject all Store beans as long as they have an &lt;Integer&gt; generic
// Store&lt;String&gt; beans will not appear in this list
@Autowired
private List&lt;Store&lt;Integer&gt;&gt; s;
</code></pre></div><ol start="5"><li>autowired into lists and arrays.</li></ol> <blockquote><p>Your target beans can implement the org.springframework.core.Ordered interface or use the @Order or standard @Priority annotation if you want items in the array or list to be sorted in a specific order. Otherwise their order will follow the registration order of the corresponding target bean definitions in the container.
The @Order annotation may be declared at target class level but also on @Bean methods, potentially being very individual per bean definition (in case of multiple definitions with the same bean class). @Order values may influence priorities at injection points, but please be aware that they do not influence singleton startup order which is an orthogonal concern determined by dependency relationships and @DependsOn declarations.
Note that the standard javax.annotation.Priority annotation is not available at the @Bean level since it cannot be declared on methods. Its semantics can be modeled through @Order values in combination with @Primary on a single bean per type.
It is also possible to provide all beans of a particular type from the ApplicationContext by adding the annotation to a field or method that expects an array of that type:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>public class MovieRecommender {

    @Autowired
    private MovieCatalog[] movieCatalogs;

    // ...
}
</code></pre></div><blockquote><p>The same applies for typed collections:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>public class MovieRecommender {

    private Set&lt;MovieCatalog&gt; movieCatalogs;

    @Autowired
    public void setMovieCatalogs(Set&lt;MovieCatalog&gt; movieCatalogs) {
        this.movieCatalogs = movieCatalogs;
    }

    // ...
}
</code></pre></div><ol start="6"><li>使用@Conditional @Profile @ConditionalOnProperty有条件地使@Configuration @Bean生效</li> <li>use the new @RestController annotation with Spring MVC applications, removing the need to add @ResponseBody to each of your @RequestMapping methods.
@RestController is a stereotype annotation that combines @ResponseBody and @Controller. More than that, it gives more meaning to your Controller and also may carry additional semantics in future releases of the framework.</li> <li>类或者方法级别的支持跨域@CrossOrigin</li> <li>使用@CookieValue接收请求中的cookie参数</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Controller
@RequestMapping(&quot;cookieValue&quot;)
public class CookieValueController {

	@RequestMapping(value = &quot;/jsessionId&quot;)
	public String jsessionId(
			@CookieValue(value = &quot;JSESSIONID&quot;, required = true, defaultValue = &quot;MyJsessionId&quot;) String jsessionId,
			Model model) {
		model.addAttribute(&quot;jsessionId&quot;, jsessionId);
		return &quot;request/cookieValue&quot;;
	}
}
</code></pre></div><ol start="10"><li>New @GetMapping, @PostMapping, @PutMapping, @DeleteMapping, and @PatchMapping composed annotations for @RequestMapping.</li> <li>Using depends-on</li></ol> <blockquote><p>If a bean is a dependency of another that usually means that one bean is set as a property of another. Typically you accomplish this with the <ref></ref> element in XML-based configuration metadata. However, sometimes dependencies between beans are less direct; for example, a static initializer in a class needs to be triggered, such as database driver registration. The depends-on attribute can explicitly force one or more beans to be initialized before the bean using this element is initialized. The following example uses the depends-on attribute to express a dependency on a single bean:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;bean id=&quot;beanOne&quot; class=&quot;ExampleBean&quot; depends-on=&quot;manager&quot;/&gt;
&lt;bean id=&quot;manager&quot; class=&quot;ManagerBean&quot; /&gt;
</code></pre></div><blockquote><p>To express a dependency on multiple beans, supply a list of bean names as the value of the depends-on attribute, with commas, whitespace and semicolons, used as valid delimiters:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;bean id=&quot;beanOne&quot; class=&quot;ExampleBean&quot; depends-on=&quot;manager,accountDao&quot;&gt;
    &lt;property name=&quot;manager&quot; ref=&quot;manager&quot; /&gt;
&lt;/bean&gt;

&lt;bean id=&quot;manager&quot; class=&quot;ManagerBean&quot; /&gt;
&lt;bean id=&quot;accountDao&quot; class=&quot;x.y.jdbc.JdbcAccountDao&quot; /&gt;
</code></pre></div><ol start="12"><li>Method injection</li></ol> <blockquote><p>In most application scenarios, most beans in the container are singletons. When a singleton bean needs to collaborate with another singleton bean, or a non-singleton bean needs to collaborate with another non-singleton bean, you typically handle the dependency by defining one bean as a property of the other. A problem arises when the bean lifecycles are different. Suppose singleton bean A needs to use non-singleton (prototype) bean B, perhaps on each method invocation on A. The container only creates the singleton bean A once, and thus only gets one opportunity to set the properties. The container cannot provide bean A with a new instance of bean B every time one is needed.</p></blockquote> <p>A solution is to forego some inversion of control. You can make bean A aware of the container by implementing the ApplicationContextAware interface, and by making a getBean(&quot;B&quot;) call to the container ask for (a typically new) bean B instance every time bean A needs it. The following is an example of this approach:</p> <div class="language- extra-class"><pre class="language-text"><code>// a class that uses a stateful Command-style class to perform some processing
package fiona.apple;

// Spring-API imports
import org.springframework.beans.BeansException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;

public class CommandManager implements ApplicationContextAware {

    private ApplicationContext applicationContext;

    public Object process(Map commandState) {
        // grab a new instance of the appropriate Command
        Command command = createCommand();
        // set the state on the (hopefully brand new) Command instance
        command.setState(commandState);
        return command.execute();
    }

    protected Command createCommand() {
        // notice the Spring API dependency!
        return this.applicationContext.getBean(&quot;command&quot;, Command.class);
    }

    public void setApplicationContext(
            ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }
}
</code></pre></div><p>The preceding is not desirable, because the business code is aware of and coupled to the Spring Framework. Method Injection, a somewhat advanced feature of the Spring IoC container, allows this use case to be handled in a clean fashion.</p> <blockquote></blockquote> <ol start="13"><li>Bean scopes</li></ol> <table><thead><tr><th style="text-align:left">Scope</th> <th style="text-align:left">Description</th></tr></thead> <tbody><tr><td style="text-align:left">singleton</td> <td style="text-align:left">(Default) Scopes a single bean definition to a single object instance per Spring IoC container.</td></tr> <tr><td style="text-align:left">prototype</td> <td style="text-align:left">Scopes a single bean definition to any number of object instances.</td></tr> <tr><td style="text-align:left">request</td> <td style="text-align:left">Scopes a single bean definition to the lifecycle of a single HTTP request; that is, each HTTP request has its own instance of a bean created off the back of a single bean definition. Only valid in the context of a web-aware Spring ApplicationContext.</td></tr> <tr><td style="text-align:left">session</td> <td style="text-align:left">Scopes a single bean definition to the lifecycle of an HTTP Session. Only valid in the context of a web-aware Spring ApplicationContext.</td></tr> <tr><td style="text-align:left">globalSession</td> <td style="text-align:left">Scopes a single bean definition to the lifecycle of a global HTTP Session. Typically only valid when used in a Portlet context. Only valid in the context of a web-aware Spring ApplicationContext.</td></tr> <tr><td style="text-align:left">application</td> <td style="text-align:left">Scopes a single bean definition to the lifecycle of a ServletContext. Only valid in the context of a web-aware Spring ApplicationContext.</td></tr> <tr><td style="text-align:left">websocket</td> <td style="text-align:left">Scopes a single bean definition to the lifecycle of a WebSocket. Only valid in the context of a web-aware Spring ApplicationContext.</td></tr></tbody></table> <ol start="14"><li>As a rule, use the prototype scope for all stateful beans and the singleton scope for stateless beans.</li> <li>当您使用具有原型bean依赖关系的单一范围bean时，请注意，在实例化时会解析依赖关系。 因此，如果您将原型范围的bean依赖注入到单例范围的bean中，则将实例化新的原型bean，然后将依赖注入到单例bean中。 原型实例是唯一提供给单例范围bean的唯一实例。 但是，假设您希望单例范围的bean在运行时重复获取原型范围的bean的新实例。 你不能依赖注入一个原型范围的bean到你的singleton bean中，因为这个注入只发生一次，当Spring容器实例化singleton bean并解析和注入它的依赖关系时。 如果在运行时不止一次需要一个原型bean的新实例.</li> <li>use the @PostConstruct annotation or specify a POJO initialization method. In the case of XML-based configuration metadata, you use the init-method attribute to specify the name of the method that has a void no-argument signature.</li> <li>Shutting down the Spring IoC container gracefully in non-web applications</li></ol> <p>This section applies only to non-web applications. Spring’s web-based ApplicationContext implementations already have code in place to shut down the Spring IoC container gracefully when the relevant web application is shut down.</p> <p>If you are using Spring’s IoC container in a non-web application environment; for example, in a rich client desktop environment; you register a shutdown hook with the JVM. Doing so ensures a graceful shutdown and calls the relevant destroy methods on your singleton beans so that all resources are released. Of course, you must still configure and implement these destroy callbacks correctly.</p> <p>To register a shutdown hook, you call the registerShutdownHook() method that is declared on the ConfigurableApplicationContext interface:</p> <div class="language- extra-class"><pre class="language-text"><code>import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public final class Boot {

    public static void main(final String[] args) throws Exception {
        ConfigurableApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);

        // add a shutdown hook for the above context...
        ctx.registerShutdownHook();

        // app runs here...

        // main method exits, hook is called prior to the app shutting down...
    }
}
</code></pre></div><ol start="18"><li>the Class name substitution PropertyPlaceholderConfigurer</li></ol> <blockquote><p>You use the PropertyPlaceholderConfigurer to externalize property values from a bean definition in a separate file using the standard Java Properties format. Doing so enables the person deploying an application to customize environment-specific properties such as database URLs and passwords, without the complexity or risk of modifying the main XML definition file or files for the container.
Consider the following XML-based configuration metadata fragment, where a DataSource with placeholder values is defined. The example shows properties configured from an external Properties file. At runtime, a PropertyPlaceholderConfigurer is applied to the metadata that will replace some properties of the DataSource. The values to replace are specified as placeholders of the form ${property-name} which follows the Ant / log4j / JSP EL style.</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;bean class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&gt;
    &lt;property name=&quot;locations&quot; value=&quot;classpath:com/foo/jdbc.properties&quot;/&gt;
&lt;/bean&gt;

&lt;bean id=&quot;dataSource&quot; destroy-method=&quot;close&quot;
        class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;&gt;
    &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driverClassName}&quot;/&gt;
    &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot;/&gt;
    &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot;/&gt;
    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;/&gt;
&lt;/bean&gt;
</code></pre></div><p>The actual values come from another file in the standard Java Properties format:</p> <div class="language- extra-class"><pre class="language-text"><code>jdbc.driverClassName=org.hsqldb.jdbcDriver
jdbc.url=jdbc:hsqldb:hsql://production:9002
jdbc.username=sa
jdbc.password=root
</code></pre></div><p>Therefore, the string ${jdbc.username} is replaced at runtime with the value 'sa', and the same applies for other placeholder values that match keys in the properties file. The PropertyPlaceholderConfigurer checks for placeholders in most properties and attributes of a bean definition. Furthermore, the placeholder prefix and suffix can be customized.</p> <p>With the context namespace introduced in Spring 2.5, it is possible to configure property placeholders with a dedicated configuration element. One or more locations can be provided as a comma-separated list in the location attribute.</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;context:property-placeholder location=&quot;classpath:com/foo/jdbc.properties&quot;/&gt;
</code></pre></div><p>The PropertyPlaceholderConfigurer not only looks for properties in the Properties file you specify. By default it also checks against the Java System properties if it cannot find a property in the specified properties files. You can customize this behavior by setting the systemPropertiesMode property of the configurer with one of the following three supported integer values:</p> <p>never (0): Never check system properties
fallback (1): Check system properties if not resolvable in the specified properties files. This is the default.
override (2): Check system properties first, before trying the specified properties files. This allows system properties to override any other property source.
Consult the PropertyPlaceholderConfigurer javadocs for more information.</p> <p>You can use the PropertyPlaceholderConfigurer to substitute class names, which is sometimes useful when you have to pick a particular implementation class at runtime. For example:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;bean class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&gt;
    &lt;property name=&quot;locations&quot;&gt;
        &lt;value&gt;classpath:com/foo/strategy.properties&lt;/value&gt;
    &lt;/property&gt;
    &lt;property name=&quot;properties&quot;&gt;
        &lt;value&gt;custom.strategy.class=com.foo.DefaultStrategy&lt;/value&gt;
    &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;serviceStrategy&quot; class=&quot;${custom.strategy.class}&quot;/&gt;
</code></pre></div><p>If the class cannot be resolved at runtime to a valid class, resolution of the bean fails when it is about to be created, which is during the preInstantiateSingletons() phase of an ApplicationContext for a non-lazy-init bean.
19. the PropertyOverrideConfigurer</p> <blockquote><p>The PropertyOverrideConfigurer, another bean factory post-processor, resembles the PropertyPlaceholderConfigurer, but unlike the latter, the original definitions can have default values or no values at all for bean properties. If an overriding Properties file does not have an entry for a certain bean property, the default context definition is used.</p></blockquote> <p>Note that the bean definition is not aware of being overridden, so it is not immediately obvious from the XML definition file that the override configurer is being used. In case of multiple PropertyOverrideConfigurer instances that define different values for the same bean property, the last one wins, due to the overriding mechanism.</p> <p>Properties file configuration lines take this format:</p> <div class="language- extra-class"><pre class="language-text"><code>beanName.property=value
</code></pre></div><p>For example:</p> <div class="language- extra-class"><pre class="language-text"><code>dataSource.driverClassName=com.mysql.jdbc.Driver
dataSource.url=jdbc:mysql:mydb
</code></pre></div><p>This example file can be used with a container definition that contains a bean called dataSource, which has driver and url properties.</p> <p>Compound property names are also supported, as long as every component of the path except the final property being overridden is already non-null (presumably initialized by the constructors). In this example…​</p> <div class="language- extra-class"><pre class="language-text"><code>foo.fred.bob.sammy=123
</code></pre></div><p>the sammy property of the bob property of the fred property of the foo bean is set to the scalar value 123.
Specified override values are always literal values; they are not translated into bean references. This convention also applies when the original value in the XML bean definition specifies a bean reference.</p> <p>With the context namespace introduced in Spring 2.5, it is possible to configure property overriding with a dedicated configuration element:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;context:property-override location=&quot;classpath:override.properties&quot;/&gt;
</code></pre></div><ol start="20"><li>Fine-tuning annotation-based autowiring with @Primary</li></ol> <blockquote><p>Because autowiring by type may lead to multiple candidates, it is often necessary to have more control over the selection process. One way to accomplish this is with Spring’s @Primary annotation. @Primary indicates that a particular bean should be given preference when multiple beans are candidates to be autowired to a single-valued dependency. If exactly one 'primary' bean exists among the candidates, it will be the autowired value.</p></blockquote> <p>Let’s assume we have the following configuration that defines firstMovieCatalog as the primary MovieCatalog.</p> <div class="language- extra-class"><pre class="language-text"><code>@Configuration
public class MovieConfiguration {

    @Bean
    @Primary
    public MovieCatalog firstMovieCatalog() { ... }

    @Bean
    public MovieCatalog secondMovieCatalog() { ... }

    // ...
}
</code></pre></div><p>With such configuration, the following MovieRecommender will be autowired with the firstMovieCatalog.</p> <div class="language- extra-class"><pre class="language-text"><code>public class MovieRecommender {

    @Autowired
    private MovieCatalog movieCatalog;

    // ...
}
</code></pre></div></div> <!----> <div class="content page-nav"><p class="inner"><span class="prev">
          ← <a href="/zhangyongxin/blog/interestingThoughts/interestingThoughts.html" class="prev">
            有趣的想法
          </a></span> <span class="next"><a href="/zhangyongxin/reprint/javaInterview/javaInterview2.html">
            Java面试题
          </a> →
        </span></p></div></div> <div id="comment-container"><div class="gt-container"><div class="gt-initing"><i class="gt-loader"></i> <p class="gt-initing-text">Gitalking ...</p></div> <!----> <!----> <div><div class="gt-header"><a class="gt-avatar-github"><span class="gt-ico gt-ico-github"><span class="gt-svg"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64 524C64 719.602 189.356 885.926 364.113 947.017 387.65799 953 384 936.115 384 924.767L384 847.107C248.118 863.007 242.674 773.052 233.5 758.001 215 726.501 171.5 718.501 184.5 703.501 215.5 687.501 247 707.501 283.5 761.501 309.956 800.642 361.366 794.075 387.658 787.497 393.403 763.997 405.637 743.042 422.353 726.638 281.774 701.609 223 615.67 223 513.5 223 464.053 239.322 418.406 271.465 381.627 251.142 320.928 273.421 269.19 276.337 261.415 334.458 256.131 394.888 302.993 399.549 306.685 432.663 297.835 470.341 293 512.5 293 554.924 293 592.81 297.896 626.075 306.853 637.426 298.219 693.46 258.054 747.5 262.966 750.382 270.652 772.185 321.292 753.058 381.083 785.516 417.956 802 463.809 802 513.5 802 615.874 742.99 701.953 601.803 726.786 625.381 750.003 640 782.295 640 818.008L640 930.653C640.752 939.626 640 948.664978 655.086 948.665 832.344 888.962 960 721.389 960 524 960 276.576 759.424 76 512 76 264.577 76 64 276.576 64 524Z"></path>
</svg>
</span> <!----></span></a> <div class="gt-header-comment"><textarea placeholder="Leave a comment" class="gt-header-textarea"></textarea> <div class="gt-header-preview markdown-body hide"></div> <div class="gt-header-controls"><a href="https://guides.github.com/features/mastering-markdown/" target="_blank" class="gt-header-controls-tip"><span class="gt-ico gt-ico-tip"><span class="gt-svg"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 366.949535c-16.065554 0-29.982212 13.405016-29.982212 29.879884l0 359.070251c0 16.167882 13.405016 29.879884 29.982212 29.879884 15.963226 0 29.879884-13.405016 29.879884-29.879884L541.879884 396.829419C541.879884 380.763865 528.474868 366.949535 512 366.949535L512 366.949535z"
    p-id="3083"></path>
  <path d="M482.017788 287.645048c0-7.776956 3.274508-15.553912 8.80024-21.181973 5.525732-5.525732 13.302688-8.80024 21.181973-8.80024 7.776956 0 15.553912 3.274508 21.079644 8.80024 5.525732 5.62806 8.80024 13.405016 8.80024 21.181973 0 7.776956-3.274508 15.656241-8.80024 21.181973-5.525732 5.525732-13.405016 8.697911-21.079644 8.697911-7.879285 0-15.656241-3.274508-21.181973-8.697911C485.292295 303.301289 482.017788 295.524333 482.017788 287.645048L482.017788 287.645048z"
    p-id="3084"></path>
  <path d="M512 946.844409c-239.8577 0-434.895573-195.037873-434.895573-434.895573 0-239.8577 195.037873-434.895573 434.895573-434.895573 239.755371 0 434.895573 195.037873 434.895573 434.895573C946.895573 751.806535 751.755371 946.844409 512 946.844409zM512 126.17088c-212.740682 0-385.880284 173.037274-385.880284 385.777955 0 212.740682 173.037274 385.777955 385.880284 385.777955 212.740682 0 385.777955-173.037274 385.777955-385.777955C897.777955 299.208154 724.740682 126.17088 512 126.17088z"
    p-id="3085"></path>
</svg>
</span> <span class="gt-ico-text">Markdown is supported</span></span></a> <!----> <button class="gt-btn gt-btn-preview"><span class="gt-btn-text">Preview</span> <!----></button> <button class="gt-btn gt-btn-login"><span class="gt-btn-text">Login with GitHub</span> <!----></button></div></div></div> <div class="gt-comments"><span></span> <p class="gt-comments-null">
                Be the first guy leaving a comment!
            </p> <!----></div></div></div></div></div> <!----></div> <div class="tool-group"><!----></div></div> <!----></div> <div class="background-mask" style="background:url(&quot;https://s1.ax1x.com/2018/12/26/F2wEkD.jpg&quot;) no-repeat fixed;"></div></div></div>
    <script src="/zhangyongxin/assets/js/29.75726558.js" defer></script><script src="/zhangyongxin/assets/js/app.74657ed2.js" defer></script>
  </body>
</html>
